<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ãƒ‹ã‚³ãƒªãƒ’ãƒˆ vs ã¤ã‚‹ã¤ã‚‹å› ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ãƒãƒˆãƒ«</title>
  <link rel="icon" type="image/png" href="http://nikorihito.com/wp-content/uploads/2024/11/ãƒ‹ã‚³ãƒªãƒ’ãƒˆ.png">
  <style>
    body {
      background: white;
      text-align: center;
      font-family: sans-serif;
      color: #333;
      padding: 20px;
    }
    img { width: 120px; margin: 10px; }
    .bar {
      width: 300px;
      height: 20px;
      background: #ddd;
      margin: 10px auto;
      position: relative;
      border-radius: 10px;
      overflow: hidden;
    }
    .inner {
      height: 100%;
      background: #4caf50;
      width: 100%;
      border-radius: 10px;
      transition: width 0.3s;
    }
    #word, #meaning { font-size: 24px; margin: 10px; }
    input { font-size: 20px; padding: 10px; width: 300px; }
    #result, #stats, #restart { margin-top: 20px; font-size: 20px; }
    button { font-size: 18px; padding: 10px 20px; margin: 20px; cursor: pointer; }
    #gameArea { display: none; }
    #restart { display: none; }
    #nikoPointButton { display: none; margin-top: 10px; }
  </style>
</head>
<body>

  <h1>ãƒ‹ã‚³ãƒªãƒ’ãƒˆ vs ã¤ã‚‹ã¤ã‚‹å› ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ãƒãƒˆãƒ«</h1>

  <div id="startArea">
    <button id="startButton">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
  </div>

  <div id="gameArea">
    <div>
      <img src="http://nikorihito.com/wp-content/uploads/2024/11/ãƒ‹ã‚³ãƒªãƒ’ãƒˆ.png" alt="ãƒ‹ã‚³ãƒªãƒ’ãƒˆ">
      <img src="http://nikorihito.com/wp-content/uploads/2024/11/ã¤ã‚‹ã¤ã‚‹å›.png" alt="ã¤ã‚‹ã¤ã‚‹å›">
    </div>

    <div>
      ãƒ‹ã‚³ãƒªãƒ’ãƒˆ HP
      <div class="bar"><div id="playerHP" class="inner"></div></div>
      ãƒ‹ã‚³ãƒªãƒã‚¤ãƒ³ãƒˆ
      <div class="bar"><div id="nikoPoint" class="inner"></div></div>
      ã¤ã‚‹ã¤ã‚‹å› HP
      <div class="bar"><div id="npcHP" class="inner"></div></div>
    </div>

    <div id="meaning">æ„å‘³ï¼š---</div>
    <div id="word">æº–å‚™ä¸­...</div>
    <input type="text" id="input" placeholder="ã“ã“ã«å…¥åŠ›" disabled>
    <button id="nikoPointButton">å¿…æ®ºæŠ€ç™ºå‹•ï¼</button>
  </div>

  <div id="result"></div>
  <div id="stats"></div>
  <div id="restart">
    <button onclick="init()">å†åº¦æŒ‘æˆ¦</button>
  </div>

  <script>
    const words = [
      { en: "I am", ja: "ç§ã¯ã€œã§ã™" },
      { en: "You are", ja: "ã‚ãªãŸã¯ã€œã§ã™" },
      { en: "He is", ja: "å½¼ã¯ã€œã§ã™" },
      { en: "She is", ja: "å½¼å¥³ã¯ã€œã§ã™" },
      { en: "It is", ja: "ãã‚Œã¯ã€œã§ã™" },
      { en: "We are", ja: "ç§ãŸã¡ã¯ã€œã§ã™" },
      { en: "They are", ja: "å½¼ã‚‰ã¯ã€œã§ã™" },
      { en: "Do you", ja: "ã‚ãªãŸã¯ã€œã—ã¾ã™ã‹ï¼Ÿ" },
      { en: "Does he", ja: "å½¼ã¯ã€œã—ã¾ã™ã‹ï¼Ÿ" },
      { en: "Can you", ja: "ã‚ãªãŸã¯ã€œã§ãã¾ã™ã‹ï¼Ÿ" },
      { en: "I have", ja: "ç§ã¯ã€œã‚’æŒã£ã¦ã„ã¾ã™" },
      { en: "He has", ja: "å½¼ã¯ã€œã‚’æŒã£ã¦ã„ã¾ã™" }
    ];

    let currentWord = {};
    let startTime = 0;
    let missCount = 0;
    let playerHP = 20000;
    let npcHP = 20000;
    let nikoPoint = 0;
    const maxNikoPoint = 100;
    let npcInterval;
    const input = document.getElementById("input");

    function startGame() {
      document.getElementById("startArea").style.display = "none";
      document.getElementById("gameArea").style.display = "block";
      input.disabled = false;
      nextWord();
      startTime = Date.now();
      missCount = 0;
      playerHP = 20000;
      npcHP = 20000;
      nikoPoint = 0;
      updateBars();
      npcInterval = setInterval(npcAttack, 1200);
    }

    function nextWord() {
      currentWord = words[Math.floor(Math.random() * words.length)];
      document.getElementById("word").textContent = currentWord.en;
      document.getElementById("meaning").textContent = "æ„å‘³: " + currentWord.ja;
      input.value = "";
      input.focus();
    }

    input.addEventListener("input", () => {
      const typed = input.value;
      if (currentWord.en.startsWith(typed)) {
        if (typed === currentWord.en) {
          npcHP -= 300;
          nikoPoint += 20;
          if (nikoPoint >= maxNikoPoint) {
            nikoPoint = maxNikoPoint;
            document.getElementById("nikoPointButton").style.display = "inline-block";
          }
          updateBars();
          if (npcHP <= 0) finishGame(true);
          else nextWord();
        }
      } else {
        missCount++;
        playerHP -= 150;
        updateBars();
        input.value = "";
        if (playerHP <= 0) finishGame(false);
      }
    });

    function npcAttack() {
      playerHP -= 250;
      updateBars();
      if (playerHP <= 0) finishGame(false);
    }

    function updateBars() {
      document.getElementById("playerHP").style.width = (playerHP / 20000 * 100) + "%";
      document.getElementById("npcHP").style.width = (npcHP / 20000 * 100) + "%";
      document.getElementById("nikoPoint").style.width = (nikoPoint / maxNikoPoint * 100) + "%";
    }

    document.getElementById("nikoPointButton").addEventListener("click", () => {
      if (nikoPoint >= maxNikoPoint) {
        npcHP -= 3000;
        nikoPoint = 0;
        document.getElementById("nikoPointButton").style.display = "none";
        updateBars();
        if (npcHP <= 0) finishGame(true);
      }
    });

    function finishGame(playerWon) {
      clearInterval(npcInterval);
      input.disabled = true;
      document.getElementById("nikoPointButton").style.display = "none";
      const timeTaken = ((Date.now() - startTime) / 1000).toFixed(2);
      document.getElementById("result").textContent = playerWon ? "ğŸ‰ ãƒ‹ã‚³ãƒªãƒ’ãƒˆã®å‹åˆ©ï¼" : "ğŸ˜¢ ã¤ã‚‹ã¤ã‚‹å›ã®å‹åˆ©...";
      document.getElementById("stats").innerHTML = `ã‚¿ã‚¤ãƒ ï¼š${timeTaken}ç§’<br>ãƒŸã‚¹æ•°ï¼š${missCount}å›`;
      document.getElementById("restart").style.display = "block";
    }

    function init() {
      document.getElementById("startArea").style.display = "block";
      document.getElementById("gameArea").style.display = "none";
      document.getElementById("result").textContent = "";
      document.getElementById("stats").textContent = "";
      document.getElementById("restart").style.display = "none";
    }

    document.getElementById("startButton").addEventListener("click", startGame);
  </script>

</body>
</html>